\documentclass{report}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathabx}
\usepackage{nicefrac}
\usepackage{verbatim}
\usepackage{mathtools}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage[bottom]{footmisc}
\graphicspath{ {./images/} }
\newtheorem{lemma}{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{theorem}{Theorem}
\newtheorem*{theorem*}{Theorem}
\newtheorem*{claim*}{Claim}
\newtheorem*{aim*}{Aim}
\newenvironment{claimproof}[1]{\vspace{2.5mm}\par\noindent\underline{Proof:}\space#1}{\hfill $\diamond$ \vspace{2.5mm} \par}
\newenvironment{aimsol}[1]{\vspace{2.5mm}\par\noindent\underline{Solution:}\space#1}{\hfill $\diamond$ \vspace{2.5mm} \par}

\newcommand{\ignore}[1]{}

\title{Distribution of Quadratic and Higher Residues and Non-Residues over Prime Fields}
\author{
  Sabreen Syed\\
  \multicolumn{1}{p{.7\textwidth}}{\centering\emph{Department of Computer Science and Engineering\\
  Indian Institute of Technology Kanpur, India}}}
\date{May 2019}

\begin{document}
%\pagecolor{black!78}
%\color{white}

\maketitle

\chapter{Introduction}
%
Let us take a quadratic equation $ax^2+bx+c=0$ with coefficients in a finite field, $\mathbb{F}_p$, and $a\neq0$, where $p$ is an odd prime. We would like to know if there exist any roots of the equation. It is equivalent to an equation $x^2+bx+c=0$ by multiplying both sides by $a^{-1}$, the multiplicative inverse of $a$. Solving,
$$x^2+bx+c=0$$
$$x^2+bx+2^{-2}b^{2}+c=2^{-2}b^{2}$$
$$x^2+2^{-1}bx+2^{-1}bx+2^{-2}b^{2}=2^{-2}b^{2}-c$$
$$(x+2^{-1}b)^2=2^{-2}b^{2}-c$$
%$$x=-2^{-1}b+\sqrt{2^{-2}b^{2}-c}$$

$2^{-2}b^{2}-c$ is called the discriminant, $D$, of the equation. The existence of a member of $\mathbb{F}_p$, say $y$, such that $y^2=D$, determines whether the equation has a solution. If such a $y$ exists, $-2^{-1}b+y$ is a solution of the equation, and if it does not exist, the equation cannot have a solution. In $\mathbb{F}_p$, such a $y$ need not exist for every $D\in\mathbb{F}_p$. We say $a\in\mathbb{F}_p$ is a quadratic residue modulo $p$, if there exists $z\in \mathbb{F}_p$ satisfying $z^2=a$.

We are concerned, in this thesis, with the distribution of quadratic residues and quadratic non-residues modulo a prime $p$ over the elements in $\mathbb{F}_p$. Apart from the theoretical interest in the matter in and of itself, it also has applications in many practicaly relevant problems. We will specifically tackle the problems of
\begin{itemize}
    \item finding a square root of an element in $\mathbb{F}_p$ and
    \item factorising quadratic polynomials in $\mathbb{F}_p$.
\end{itemize}
In this chapter we will explore the background and preliminaries needed for the rest of the thesis.

\subsection*{Deterministic versus probabilistic algorithms}

Let us determine how many elements of $\mathbb{F}_p$ are quadratic residues. We see that since $(p-x)^2\equiv(-x)^2\equiv x^2\textrm{  }(mod\textrm{ }p)$, $x$ and its additive inverse have the same square in $\mathbb{F}_p$. The additive inverse of an element in $\mathbb{F}_p$ is itself only if $-x=x \Rightarrow x=0$, in which case $x^2=0$. Thus, there are at least 2 distinct elements in $1\ldots p-1$ which map to each quadratic residue in $1\ldots p-1$, and thus at most half of $1\ldots p-1$ are quadratic residues.

Now if $x^2\equiv y^2 \textrm{ }(mod\textrm{ } p)$, then $(x-y)(x+y)\equiv 0\textrm{ }(mod\textrm{ } p)$. Thus, $x-y\divides p$ or $x+y\divides p$ $\Rightarrow x\equiv \pm y \textrm{ } (mod\textrm{ } p)$, which means only additive inverses can have the same square modulo $p$. Thus, exactly half of $1$ to $p-1$ are quadratic residues.

As will be explained later in the thesis, the problems of finding a square root and of factorising square-free quadratic polynomials in $\mathbb{F}_p$, are equivalent to finding a quadratic non-residue and to computing a shifted\footnotemark polynomial such that its constant term is a qudratic residue, respectively. Since half of elements in $1$ to $p-1$ are quadratic non-residues, a simple probabilistic approach would be to randomly select an element of $\mathbb{F}_p*$ and check if it is a quadratic non-residue for finding a quadratic non-residue, or computing a random shifted polynomial and check if its constant term is a non-residue for the respective problems. The former will be successful with probability $\nicefrac{1}{2}$. However, in the worst case, we need to check $\frac{p-1}{2}+1$ elements to get a quadratic non-residue by this method, and thus there is no guaranteed upper bound lesser than $O(p)$ on the time taken, using this method. The latter problem will also be successful with an approxipate probability of about $~\nicefrac{1}{2}$, which we will see later in the thesis after we are acquainted with Lemma 1. Thus, we would also like efficient deterministic approaches to the problems because, apart from the theoretical interest in the problems, we would also like to theoretically bound their solving time.

We will explore deterministic approaches to the problems in this thesis. Our overall approach to the problems is seriate: we de-randomise the respective random algorithms by checking consecutive candidates. In the first problem of finding a quadratic non-residue, we check consecutive elements of $\mathbb{F}_p*$ from $1,2,3...$ onwards for a quadratic non residue. For the second problem of computing a shifted polynomial such that its constant term is a qudratic residue, we check the polynomials shifted by $1,2,3..$ onwards to see if their constant terms are quadratic non-residues. This relies on the the null hypothesis for correlation between proximity of numbers and their quadratic residuousity. In any case, it is the most straightforward effeciently computable deterministic pattern, and unless there is reason to consider a non-seriate approach, we consider it good enough for our purposes.

We now move on to preliminaries required for understanding the thesis.
%
%
\section{Preliminaries}
%Discuss general characters with first demonstrating examples with quadratic ones.
In this section, we explain concepts which a reader may not be familiar with, which are required for understanding remainder of the thesis. All convention and notation will be covered in the next section, hence this section can be skipped for those who are familiar with the concepts.
\subsection{Modulo arithmetic}
A modulo equivalency for integers $a$, $b$ and $c$ is written as
\[a\equiv b\mod c\]
which is read as ``$a$ is equivalent to $b$ modulo $c$''. The modulo equivalency is related to arithmetic equality as:
\[a\equiv b\mod  c \Leftrightarrow a-b = nc\text{ for some }n\in Z\]
We now list some properties of a modulo equivalencies. We will only prove the property if the proof is not straightforward.
\begin{enumerate}
    \item Adding the same integer to both sides of the equivalency upholds the equivalency, i.e. $a\equiv b\mod  c \Rightarrow a+d\equiv b+d\mod  c$
    \item Multiplying both sides of the equivalency by the same integer upholds the equivalency, i.e. $a\equiv b\mod  c \Rightarrow a.d\equiv b.d\mod  c$
    \item Exponentiating both sides of the equivalency to the same whole number upholds the equivalency, because
    \[a\equiv b\mod c \Rightarrow a = b+ nc\text{ for some }n\in Z\]
    \[\Rightarrow a^d = (b + nc)^d \Rightarrow a^d = b^d + mc \text{ for some }m\in Z\]
    \[\Rightarrow a^d - b^d = mc \Rightarrow a^d\equiv b^d\mod  c\]
    \item Dividing both sides by the same number (say $d$) upholds the equivalency, provided both sides are divisible by $d$, and $c$ \& $d$ are co-prime. This is because:
    \[a\equiv b\mod  c \Rightarrow a-b = nc\text{ for some }n\in Z\]
    \[\Rightarrow \frac{a-b}{d} = \frac{nc}{d}\]
    Since $a$ \& $b$ are divisible by $d$, $d\divides a-b \Rightarrow d\divides nc$, and thus ${nc}{d}$ is an integer. Since $c$ \& $d$ are co-prime and have no common factors, $d\divides nc \Rightarrow d \divides n$.  Thus $\nicefrac{n}{d}$ is an integer, and thus $\frac{a-b}{d} = \frac{n}{d}.c \Rightarrow \nicefrac{a}{d}\equiv \nicefrac{b}{d}\mod  c$
\end{enumerate}
%
\subsection{Operations on complex numbers}
Complex numbers can be geometrically represented on the complex plane. It has two mutually perpendicular axes: the real axis and the imaginary axis. As in figure \ref{fig:complex_plane}, the complex number $z=a+ib$ is represented by the point $a$ units to the right of (or $-a$ units to the left of) the imaginary axis and $b$ units above (or $-b$ units below) the real axis.
\begin{figure}
\includegraphics[scale=0.25]{complex_plane}
\centering
\caption{Visual representation of the complex plane}
\label{fig:complex_plane}
\end{figure}
We can also associate a vector $\vec{z}$ with the complex number $z$, a vector from the origin to the point represented by $z$. The vector is particularly helpful in visualizing operations on complex numbers. The length of the vector, say $r$, and its counter-clockwise angle with the real axis, say $\theta$, give us the polar representation of $a+ib$ which is $re^{i\theta}$, where $e$ is Euler's constant, since $a=r\cos(\theta)$ and $b=r\sin(\theta)$

We now list how operations on complex numbers can be represented on the complex plane vectors by studying the vectors associated with the complex numbers. The vector associated with a complex number $z$ is given by $\vec{z}$.
\begin{figure}
\includegraphics[scale=0.3]{vector_addition}
\centering
\caption{Visual representation of complex addition}
\label{fig:vector_addition}
\end{figure}
%
\begin{enumerate}
    \item \textit{Modulus}: The modulus of a complex number $z$, given by $\lvert z\rvert$, is the length of $\vec{z}$.
    \item \textit{Negation}: Negating a complex number $z$ results in a vector with the same magnitude as $\vec{z}$ but with the opposite direction
    \item \textit{Congugation}: Conjugation of a complex number $a+ib$ results in $a-ib$, and the vector $\vec{a+ib}$ is reflected across the imaginary axis.
    \item \textit{Addition (and subtraction)}: Adding two complex numbers $z_1$ and $z_2$ is equivalent to placing one vector, say $z_1$ with its tail on the origin, and placing the tail of $z_2$ on the head of $z_1$, as in the figure \ref{fig:vector_addition}, where $z_3 = z_1+z_2$. Subtracting $z_2$ from $z_1$ is just adding $z_1$ and $-z_2$.
    \item \textit{Multiplicative inversion}: The inverse $z^{-1}$ ($z\neq 0$) of a complex number $z=re^{i\theta}$ is $r^{-1}e^{i(-\theta)}$. Thus $\vec{z^{-1}}$ is a vector with length $r^{-1}$ and angle with real axis $-\theta$, i.e. reflected across the real axis.
    \item \textit{Multiplication (and division)}: Multiplying two complex numbers $z_1=r_1e^{i\theta_1}$ and $z_2=r_2e^{i\theta_2}$ results in $z_3=r_1r_2e^{i{\theta_1+\theta_2}}$, thus $\vec{z_3}$ is a vector with magnitude the product of the magnitudes of $z_1$ \& $z_2$ and angle with real axis the sum of both angles of  $z_1$ \& $z_2$. Division, $\nicefrac{z_1}{z2},z_2\neq 0$, is just multplying $z_1$ with $z_2^{-1}$.
\end{enumerate}


%
%
\section{Symbols and conventions}
%Character is
%
%
\section{Interval sums of quadratic residues}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Upper Bounds on Uniform Character Value Intervals}
%Aim: Introduce Weil's Theorem and then Lemma 2. Give a basic qualitative proof of the p^{1/2} bound and the Burgess bound for quadratic residues, and extend the result to a general residue. Generalise the S_h^{2r} result to the sum of quadratic residues of the quadratic polynomial for a subset, explain if the p^{1/2} bound can be made in an interval and explain why further extensions cannot be made to p^{1/4+\delta}
In this chapter, we present a straightforward proof of a weak version of the original result discussed by Burgess in \cite{burgess}. We prove the following theorem:
\begin{theorem} \label{thm:p4bound}
Given a quadratic character $\chi_2$ modulo prime $p$, for any $H>p^{\nicefrac{1}{4}+\delta}$, where $\delta>0$:
\[\sum\limits_{n=x+1}^{n+H}\lvert\chi_2(n)\rvert<H\]
for any $x\in\mathbb{Z}$, for large enough $p$.
\end{theorem}
The starting point for our analysis is lemma 1 derived from Weil's theorem:
%
\begin{lemma}
\textup{\cite{burgess}}Let $f(x)$ be a monic square-free polynomial of degree $\nu$, with coefficients from $\mathbb{Z}$, reducible into linear factors. Then,
$$\Big\lvert\sum\limits_{x=0}^{p-1}\chi_2(f(x))\Big\rvert\leq (\nu -1)p^{\nicefrac{1}{2}}$$
\end{lemma}
%
Lemma 1 exhibits the low correlation between the distribution of values a square-free polynomial takes in $\mathbb{F}_p$, and the distribution of quadratic residues, as follows: The sum of $\chi_2$ values in an interval determines the relative count of quadratic residues and non-residues in it. The sum would cancel out to small magnitudes if the counts were nearly equal, or be closer in magnitude to the size of the interval if not. Thus, lemma 1 essentially tells us that a square-free polynomial over $\mathbb{F}_p$ would assume a roughly equal number of quadratic residues and non-residues over $\mathbb{F}_p$.

We deduce lemma 2 in the next section by constructing an appropriate polynomial exploiting lemma 1 for our purpose of finding low upper bounds on the number of continuous quadratic residues or continuous non-residues.
%
%
\section{A useful global sum and the $O(p^{\nicefrac{1}{2}})$ bound}
Let us consider the sum of $\chi_2$ values in an interval of size $h$.

$$S_h(x)=\sum\limits_{n=1}^{h}\chi_2(x+n)$$

Given Lemma 1, which limits the sum of $\chi_2$ values of a polynomial over the entire interval $0$ to $p-1$, we would like to construct square-free polynomials which are such that lemma 1 could be applied to successfully put a bound on the sum of $\chi_2$ values in a smaller interval. We do this by expanding the sum $\sum\limits_{x=0}^{p-1}(S_h(x))^{2r}$:

$$(S_h(x))^{2r}= \bigg(\sum\limits_{n=1}^{h}\chi_2(x+n)\bigg)^{\mathclap{2r}} =\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{2r}=1}}^h\chi_2(x+m_1)\chi_2(x+m_2)...\chi_2(x+m_{2r})$$
$$\sum\limits_{x=0}^{p-1}(S_h(x))^{2r}=\sum\limits_{x=0}^{p-1}\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{m_{2r}=1}^h\chi_2(x+m_1)\chi_2(x+m_2)..\chi_2(x+m_{2r})$$
\begin{equation} \label{sumpoly}
\sum\limits_{x=0}^{p-1} (S_h(x))^{2r} =\sum\limits_{m_1=1}^h \sum\limits_{m_2=1}^h... \sum\limits_{m_{2r}=1}^h\sum\limits_{x=0}^{p-1}\chi_2\big((x+m_1)(x+m_2)..(x+m_{2r})\big)
\end{equation}

To use lemma 1 to estimate the expression in equation \ref{sumpoly}, we need to separate the perfect square polynomials of the form $\prod_{a=1}^{2r}(x+m_a)$ from the rest. To achieve this, we separate the ordered sequences or `tuples' in (\ref{sumpoly}), $(m_1, m_2...m_{2r})$, into two sets based on the multiplicity of distinct values in the tuple:
\begin{itemize}
  \item Set 1 consists of those tuples which contain an even count of each distinct number in them. This set forms a bijective correspondence with every perfect square polynomial among the polynomials considered. Since there are $\frac{(2r)!}{2^rr!}$ ways to choose pairs of positions in a tuple and there are $h^{r}$ ways of filling them with values from $1$ to $h$, so there are less than $(2r)^r h^{r}$ such polynomials. Since the maximum value contributed to the sum of $\chi_2$ values over all $p$ values of $x$ from each such polynomial is at most $p$, the contribution to the sum is at most $(2r)^r h^{r}p$.
  \item Set 2 consists of the rest of the tuples after removing set 1, which similarly correspond bijectively to the leftover polynomials (i.e. not perfect squares) exactly. Since there are $h^{2r}$ polynomials in all, trivially at most $h^{2r}$ are not perfect square polynomials. These polynomials are of the form:
  $$(x+s_1)^{e_1}(x+s_2)^{o_2}...(x+s_k)^{e_k}$$
  Where $s_i, i\in 1...k$ are distinct members of the tuple corresponding to the polynomial and $e_i$ and $o_i$ are even or odd powers respectively of the $i^{th}$ term. Now, $\chi\big((x+s_1)^{e_1}(x+s_2)^{o_2}...(x+s_k)^{e_k}\big)$ evaluates the same as $\chi\big((x+s_2)^{o_2}...(x+s_{k'})^{o_{k'}}\big)$ (taking all odd-powered factors) for all except at most $r$ values of $x$ (corresponding to the even-powered factors evaluating to $0$). Thus, their contribution to the sum is not more than $h^{2r}(p^{\nicefrac{1}{2}}(2r-1)+r)$.
\end{itemize}
%
We state lemma 2, which directly follows from what we have calculated so far.
%
\begin{lemma} \label{lemma2statement}
Let $S_h(x)=\sum\limits_{n=1}^{h}\chi_2(x+n)$. Then,
\begin{equation} \label{lemma2}
\sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert ^{2r}\leq h^{r}(2r)^{r}p+h^{2r}r(2p^{\nicefrac{1}{2}}+1)
\end{equation}
\end{lemma}
%%
\subsection*{The $O(p^{\nicefrac{1}{2}})$ bound}
We prove the $O(p^{\nicefrac{1}{2}})$ bound on the longest interval of continuous quadratic residues or of continuous quadratic non-residues, i.e., we prove the following claim:
\begin{claim*}
Given a quadratic character $\chi_2$ modulo prime $p$, let $h$ be the greatest integer such that:
\[\bigg\lvert\sum\limits_{n=x+1}^{x+h}\chi_2(n)\bigg\rvert=h\]
 for any $x\in\mathbb{Z}$. Then $h\in O(p^{\nicefrac{1}{2}})$.
\end{claim*}
\begin{claimproof}
We show that if the $O(p^{\nicefrac{1}{2}})$ bound is not true, then lemma \ref{lemma2statement} is contradicted for large enough $p$.\\
It is given that $\lvert S_h(z)\rvert=h$ for some $z\in \mathbb{F}_p$. Consider the LHS of (\ref{lemma2}) in that case. As $\lvert S_h(x+k)\rvert \geq \lvert S_h(x)\rvert-2k$,
\begin{equation} \label{intervcontr}
\sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert^{2r}\geq\sum\limits_{x=z}^{z+\lfloor\nicefrac{h}{4}\rfloor}\lvert S_h(x)\rvert^{2r} \geq h^{2r}+(h-2)^{2r}+...+(h-2\lfloor\nicefrac{h}{4}\rfloor)^{2r} \geq \frac{h^{2r+1}}{2^{2r+2}}
\end{equation}
Thus, by considering sliding intervals starting from the original interval starting at $z$, we have increased the contribution to the sum, from $h^{2r}$ of the lone interval, to $O(h^{2r+1})$ of the cascade of sliding intervals. Now, from (\ref{lemma2}) in lemma \ref{lemma2statement} and (\ref{intervcontr}):
$$ \frac{h^{2r+1}}{2^{2r+2}} \leq h^{r}(2r)^{r}p+h^{2r}r(2p^{\nicefrac{1}{2}}+1)$$
Now we set $r=1$ and divide both sides by $h^{2}$. We get:
\begin{equation} \label{contreq1}
\frac{h}{2^{4}} \leq 2h^{-1}p+(2p^{\nicefrac{1}{2}}+1)
\end{equation}
Substituting $cp^{\nicefrac{1}{2}}$ in place of $h$, we obtain the inequality
\begin{equation} \label{contreq2}
\frac{cp^{\nicefrac{1}{2}}}{16} \leq 2c^{-1}p^{\nicefrac{1}{2}}+2p^{\nicefrac{1}{2}}+1
\end{equation}
Comparing the coefficients of the highest power term $p^{\nicefrac{1}{2}}$ on each side, we see that there exists some constant $c_o$ such that $\nicefrac{c}{16}>2c^{-1}+2$ when $c>c_o$. Hence for $c>c_o$, (\ref{contreq2}) does not hold for large enough $p$. Hence, (\ref{contreq1}) cannot hold if $h=cp^{\nicefrac{1}{2}}$ such that $c>c_o$ for large enough $p$. Since the LHS of (\ref{contreq1}) increases with increase in $h$, while the RHS decreases with increase in $h$, (\ref{contreq1}) cannot hold if $h=cp^{\nicefrac{1}{2}}$ such that $c>c_o$ for large enough $p$, which means $h\leq c_op^{\nicefrac{1}{2}}$ for large enough $p$, and thus $h\in O(p^{\nicefrac{1}{2}})$.
\end{claimproof}
%
%
\section{The amplification of an interval}
We saw in the previous section how cascading an interval into many sliding intervals increased its contribution to a lower bound on the sum-expression which which was bounded above in lemma \ref{lemma2statement}, which lead to a contradiction for long enough intervals. We now describe an additional process to increase the aforementioned contribution: We show in the following claim how an interval can be transformed into many smaller intervals which are equivalent to the original interval in terms of the distribution of quadratic residues and non-residues in them.
%We saw in the previous section how we split an interval in $\mathbb{F}_p$ of size $O(p^{\nicefrac{1}{2}})$ into smaller sliding intervals and used lemma 2 to obtain the bound. What we do in this section is one step further: we show that an interval is equivalent to several small intervals in terms of the number of quadratic residues and non-residues in it. This would be useful to further amplify the contribution of an interval when applying lemma 2.

\begin{claim*}
Let $I$ be an interval in $\mathbb{F}_p$ of size $H+1$. Then multiplying each element of $I$ by $q^{-1}$ ($q\in\mathbb{F}_p, q < p$), results in $q$ intervals of sizes $\big \lfloor \nicefrac{(H+1)}{q}\big\rfloor$ or $\big \lceil \nicefrac{(H+1)}{q}\big\rceil$ throughout $\mathbb{F}_p$, with any pair of starting elements of consecutive intervals having differences $\big \lfloor\nicefrac{p}{q}\big\rfloor$ or $\big \lceil\nicefrac{p}{q}\big\rceil$, such that the intervals cumulatively have either the same numbers of quadratic residues and of non-residues as $I$, or the counts of quadratic residues and of non-residues are interchanged.
\end{claim*}

\begin{claimproof}
Let $I$ consist of the elements $\{N,N+1,...\text{ }N+H\}$. We multiply,in $\mathbb{F}_p$, each element in $I$ by $q^{-1}$ resulting in the set of elements $\{Nq^{-1},(N+1)q^{-1}...(N+H)q^{-1}\}$, which we can refer to as $Iq^{-1}$. A general resulting element is:
\begin{equation} \label{smallinterval}
    (N+k)q^{-1}=(N+nq+s)q^{-1}=Nq^{-1}+sq^{-1}+n
\end{equation}
where $k=nq+s$ and $0\leq s<q$, with $n,s\in\mathbb{Z}$, by the quotient-remainder theorem considering $k$'s properties as an element of $\mathbb{Z}$. $n$ takes values from $0$ to $\lfloor\nicefrac{(H-s)}{q}\rfloor$ for a particular $s$, since $k$ varies from $0$ to $H$ and thus $nq+s\leq H \Rightarrow n\leq \nicefrac{(H-s)}{q}$.

We elucidate the $q$ constructed intervals as follows: Adding to $Nq^{-1}+sq^{-1}$ a value of $n$ from $\{0,1,...\lfloor\nicefrac{(H-s)}{q}\rfloor\}$, for every possible $n$ for each $s$, results in all the elements of $Iq^{-1}$ as shown by (\ref{smallinterval}). Thus, there are $q$ small intervals of size $\lfloor\nicefrac{(H-s)}{q}\rfloor +1$ starting at $Nq^{-1}+sq^{-1}$ for each value of $s$. These intervals are disjoint because, being in a field, distinct $(N+k)$ result in different values of $(N+k)q^{-1}$.

We now arithmetically calculate the exact values of a small interval $\{(N+s)q^{-1},(N+s)q^{-1}+1, ...,(N+s)q^{-1}+\lfloor\nicefrac{(H-s)}{q}\rfloor\}$, since these values are still in terms of $q^{-1}$. Since $N+s\equiv N+s+up\pmod p  \text{ } \forall u\in \mathbb{Z}$:
\[\chi((N+s)q^{-1})=\chi((N+s+up)q^{-1}) \text{  } \forall u\in \mathbb{Z}\]
For $t_1,t_2\in\{0, 1,... q-1\}$, we can say
\[N+s+t_1p \equiv N+s+t_2p \pmod q \Rightarrow t_1=t_2\]
Thus, for exactly one $t\in\{0, 1,... q-1\}$ for each $s$, $N+s+tp \equiv 0 \pmod q$, i.e. $q\divides N+s+tp$. Now, for such $t$,
\[((N+s)q^{-1})q\equiv N+s \equiv N+s+tp \pmod p\]
\[\Rightarrow (N+s)q^{-1} \equiv \frac{N+s+tp}{q} \pmod p\]
since $q\divides N+s+tp$ and $\gcd (q,p)=1$. Thus,
\[\Rightarrow (N+s)q^{-1} + m\equiv \frac{N+s+tp}{q} + m \pmod p\]
Hence, the small interval from $Nq^{-1}+sq^{-1}$ to $Nq^{-1}+sq^{-1} + \lfloor\nicefrac{(H-s)}{q}\rfloor$ is equivalent modulo $p$ to the integers occurring in $[\nicefrac{(N+s+tp)}{q},\nicefrac{(N+s+tp+H-s)}{q}]$, which are the same as those in $[\nicefrac{(N+tp)}{q},\nicefrac{(N+tp+H)}{q}]$. For $s_1,s_2\in\{0, 1,... q-1\}$,
\[N+s_1+tp \equiv N+s_2+tp \pmod q \Rightarrow s_1=s_2\]
Thus, each value of $s$ has a different corresponding value of $t$ which makes $ N+s+tp$ divisible by $q$. Hence, the set union of all $q$ integer intervals is equivalent, modulo $p$, to the integers in $\bigcup\limits_{t=0}^{q-1} [\nicefrac {(N+tp)} {q},\nicefrac {(N+tp+H)}{q}]$.

The small intervals each start at $\frac{N+s+tp}{q}$ for some $s$ and $t$, thus consecutive intervals are of the form $\frac{N+s_1+tp}{q}$ and $\frac{N+s_2+(t+1)p}{q}$, where $s_1,s_2\in \{0,1,...q-1\}$, since
\[0<s_i<q<p \ \forall s_i\! \in \! \{0,1,...q-1\}\Rightarrow s_1-s_2 < p \Rightarrow s_1 < p + s_2\]
\[ \Rightarrow \frac{N+s_1+tp}{q}<\frac{N+s_2+(t+1)p}{q}\]
Thus the length between two consecutive intervals is of the form $\frac{p+\Delta s}{q}$ ($\Delta s$ being the difference between two values of $s$). Since it can only take integer values, and $-q<\Delta s<q$, the values which $\frac{p+\Delta s}{q}$ can take are $\big \lfloor\nicefrac{p}{q}\big\rfloor$ and $\big \lceil \nicefrac {p}{q}\big\rceil$.

Multiplying the entire interval $I$ by $q^{-1}$ preserves or interchanges the original cardinalities of quadratic residues and non-residues, because $\chi((N+k)q^{-1})=\chi(q^{-1})\chi(N+k)\ \forall k \in \{0,1,...,H\}$ and $\chi(q^{-1})$ is a constant. The small intervals constructed are thus equivalent to the original interval $I$ in this sense.
\end{claimproof}
We now prove a lemma which allows us to include many more such small intervals as created in the claim above in a lower bound calculation of the sum-expression which is bound above in lemma \ref{lemma2statement} by proving that when multiplying $I$ by several different values of $q^{-1}$, many of the resulting small intervals are disjoint, which will further lower the possible maximum length of any interval of only quadratic residues or only quadratic non-residues.
%
\begin{lemma}
\textup{\cite{burgess}}Given is a set $\mathcal{Q}$ of $Q$ distinct natural numbers, whose general member is given by $q$, which are pairwise co-prime, and any natural numbers $N$ and $H$ such that for any $q\in\mathcal{Q}$:
\begin{equation} \label{lemma3cond}
2Hq<p
\end{equation}
Let us denote by $I(q,t)$ the real interval
$$\frac{N+tp}{q} < z \leq \frac{N+H+tp}{q}$$
Then it is possible to associate with each $q$ a set $T(q)\subseteq \{0,1,\ldots q-1\}$ of size at least $q-Q$, such that $\forall q_1,q_2\! \in\! \mathcal{Q} \ \forall t_1\! \in\! T(q_1)\  \forall t_2\! \in\! T(q_2)\  I(q_1,t_1)\cap I(q_2,t_2) = \phi$ provided $(q_1,t_1) \neq (q_2,t_2)$.
\end{lemma}
\begin{proof}
For a given $q$, say $q_o$, we note that for consecutive $t$, $I(q_o,t)$ differ by $\nicefrac{p}{q_o}$ in their starting points. Since each $I(q_o,t)$ has a width of $\nicefrac{H}{q_o}$ and $H<p$, all $I(q_o,t)$ are disjoint for a given $q_o$. The $I(q_o,t)$ are in fact very narrow compared to the difference between their starting points, by a factor of $\nicefrac{\big(\frac{H}{q_o}\big)}{\big(\frac{p}{q_o}}\big)$ which is less than $\nicefrac{1}{2q_o}$ by (\ref{lemma3cond}). We can thus define for convenience in visualization, two terms:
\begin{itemize}
    \item Block: The closed interval between two points on the real line, the points being the 'edges' of the block. A `$q_o$-block' is the stretch between the starting points of two consecutive intervals $I(q_o,t)$ and $I(q_o,t+1)$ for some $t\in\{0,1,...q_o-1\}$, i.e. the closed interval with end points $\nicefrac{(N+pt)}{q_o}$ and $\nicefrac{(N+pt+p)}{q_o}$.
    \item Fringe: A narrow interval at the start of a block. A `$q_o$-fringe' is the interval $I(q_o,t)$ for some $t\in\{0,1,...q_o-1\}$, with respect to the block formed by the points $\nicefrac{(N+pt)}{q_o}$ and $\nicefrac{(N+pt+p)}{q_o}$.
\end{itemize}
\begin{figure}
\includegraphics[scale=0.4]{block_fringe}
\centering
\caption{Visual representation in the number line of a block and a fringe}
\label{fig:block_fringe}
\end{figure}
They are illustrated in figure \ref{fig:block_fringe}. We make the following claim about two sets of blocks:
%
\begin{claim*}
  Let $u$ and $v$ be two co-prime numbers. From a point, say $z$, on the real line, lay blocks of length $u$ consecutively in the positive direction of the real axis. Similarly, from $z$ again, lay blocks of size $v$ consecutively in the positive direction as in figure \ref{fig:block_align}.
  \begin{figure}
  \includegraphics[width=\textwidth]{block_align}
  \centering
  \caption{Laying blocks of co-prime sizes}
  \label{fig:block_align}
  \end{figure}
  Then the first point of coincidence of an end points of any of the blocks of size $u$ and an end point of any of the blocks of size $v$, following $z$, is after $v$ blocks of size $u$ and $u$ blocks of size $v$.
\end{claim*}
\begin{claimproof}
  Since, $u$ and $v$ are co-prime, $lcm(u,v)=uv$. If, for the sake of contradiction, say the first coinciding point was after $s$ blocks of size $u$, where $s<v$, then $v \divides su\Rightarrow lcm(u,v) \leq su < uv$, which is a contradiction. Since $u\divides uv$ and $v \divides uv$, there is a coinciding point after $v$ blocks of size $u$ and $u$ blocks of size $v$, which is the first coinciding point after $z$.
\end{claimproof}
%
Now take two values of $q$, $q_1$ and $q_2$ such that  $q_1\neq q_2$, and without loss of generality assume $q_1<q_2$. The $q_1$-blocks are $\nicefrac{p}{q_1}$ in size, while the $q_2$-blocks are of size $\nicefrac{p}{q_2}$. If, assume, a $q_1$-fringe overlaps with a $q_2$-fringe, then, to align the start edges of the $q_1$-block and $q_2$-block whose fringes overlap, we shift the $q_1$-blocks along the real axis by the minimum possible distance, which is a maximum of $\nicefrac{H}{q_1}$ in either the positive or negative direction. Let us now scale the real line by multiplying it by $\nicefrac{q_1q_2}{p}$. The resulting scaled $q_1$-blocks and $q_2$-blocks thus formed are then of lengths $q_2$ and $q_1$ respectively. Thus the points at which a $q_1$-block edge coincides with a $q_2$-block edge are separated by $q_1$ $q_1$-blocks and $q_2$ $q_2$-blocks, and also the least distance between all other pairs of edges is at least $1$ in the new shifted-and-scaled real axis due the integer length blocks. Thus, after un-scaling the shifted real line, the point at which the $q_1$-block edges and $q_2$-block edges coincide is only after a length of $p$, and the length of $1$ becomes $\nicefrac{p}{q_1q_2}$. So in the original unshifted and unscaled real line, a length of $\nicefrac{p}{q_1q_2}$ between a $q_1$-block edge and a $q_2$-block edge becomes a minimum of $\nicefrac{p}{q_1q_2}-\nicefrac{H}{q_1}>\nicefrac{H}{q_1}$ which is greater than both fringe widths, and hence the fringes cannot overlap in that case. Thus the intervals overlap at most once in a length of $p$.

Thus, considering the intersections for a pair $(q_1,q_2)$, we can exclude at most one value $t_1\in\{0,1,...q_1-1\}$ from being included in $T(q_1)$ and at most one value $t_2\in\{0,1,...q_2-1\}$ from being included in $T(q_2)$. Hence, for each $q_o\in \mathcal{Q}$, there are at least $q-Q$ values of $t\in \{0,1,\ldots q-1\}$ such that $I(q_o,t)$ are disjoint from all intervals associated with $q'\in \mathcal{Q}-\{q_o\}$.

\begin{comment}
Thus the points at which a $q_1$-block edge coincides with a $q_2$-block edge are separated by $q_1$ $q_1$-blocks and $q_2$ $q_2$-blocks. Thus, in the unscaled real line, the point which they coincide is after a length of $p$, due to rescaling by a factor of $\nicefrac{p}{q_1q_2}$. Now for $t \in \{ 0,1,...,q-1\}$, the range of all $I(q_1,t)$ is $[\nicefrac{N}{q_1}, \nicefrac{(N+pq_1)}{q_1}]$ and that of all $I(q_2,t)$ is $[\nicefrac{N}{q_2}, \nicefrac{(N+pq_2)}{q_2}]$. Since the overlapping region of the ranges is less than $p$, there can only be not more than one coincidence point. The fringes (intervals) being of maximum width $\nicefrac{H}{q_1}$, less than the least possible separation between a $q_1$-block edge and a $q_2$-block edge which are non-coinciding ($\nicefrac{p}{q_1q_2}$), the fringes cannot intersect anywhere else. %correct the separation thing
\end{comment}

%The starting $I(q_o,t)$ are spread over an interval of size $p$, evenly spaced by $\nicefrac{p}{q_o}$
\begin{comment}
For a fixed $q$, $I(q,t)$ are disjoint as $H<p$. Now, for a pair of different values of $q$, say $q_1$ and $q_2$, let $I(q_1,t_1)$ and $I(q_2,t_2)$ intersect. Then we can say:
$$\frac{N+t_1p}{q_1} \leq \frac{N+H+t_2p}{q_2}$$
$$\text{and}\text{ }\frac{N+t_2p}{q_2} \leq \frac{N+H+t_1p}{q_1}$$
$$\Rightarrow N(q_2-q_1)+(t_1q_2-t_2q_1)p\leq Hq_2<\frac{1}{2}p$$
$$\Rightarrow N(q_1-q_2)+(t_2q_1-t_1q_2)p\leq Hq_1<\frac{1}{2}p$$
$$\Rightarrow N(q_2-q_1)-\frac{1}{2}p < (t_2q_1-t_1q_2)p <N(q_2-q_1)+\frac{1}{2}p$$
Since not more than a single multiple of $p$ can occur in a range of size less than $p$, $t_2q_1-t_1q_2$ can take only one value. Because $q_1$ and $q_2$ are co-prime and $0\leq t_1 \leq q_1$ and $0\leq t_2 \leq q_2$, there is only one pair of $t_1$ and $t_2$ values for a unique $t_2q_1-t_1q_2$. This is because for a unique valuation of $t_2q_1-t_1q_2$, the difference in the valuation of the first term must be same as that of the second term for different values of $t_2$. The values of $t_2q_1$ will be multiples of $q_1$, and for the difference in two such values to be the same as two values of $t_1q_2$, a multiple of $q_2$, the least possible difference can be the l.c.m $q_1q_2$, which cannot occur from given range of $t_1$ and $t_2$.

Hence, for each $q$, there are at least $q-Q$ values of $t\in \{0,1,\ldots q-1\}$ such that $I(q,t)$ are disjoint from all other intervals associated with all $q$.
\end{comment}
\end{proof}

Hence, we can now see that multiplying an interval $I$ in $\mathbb{F}_p$ by many values of $q^{-1}$ for appropriate values of $q$, can lead to many non-intersecting small intervals in $\mathbb{F}_p$ which are very similar to the original interval $I$ in terms of the number of quadratic residues and non-residues in them. These non-intersecting intervals can be cascaded as in eq. \ref{intervcontr} and summed in a lower bound calculation of the sum-expression which is bounded above in lemma \ref{lemma2statement}, to further lower the bound from $O(p^{\nicefrac{1}{2}})$. This leads to the $O(p^{\nicefrac{1}{4}+\delta})$ bound on the least quadratic residue, which we now proceed to prove in the next section.
%
%
\section{The $p^{\nicefrac{1}{4}+\delta}$ bound}
We now proceed to proving the upper bound in theorem \ref{thm:p4bound} on the least quadratic non-residue, using the results proven thus. We restate the theorem:
\begin{theorem*}
Given a quadratic character $\chi_2$ modulo prime $p$, for any $H>p^{\nicefrac{1}{4}+\delta}$, where $\delta>0$:
\[\sum\limits_{n=x+1}^{n+H}\lvert\chi_2(n)\rvert<H\]
for any $x\in\mathbb{Z}$, for large enough $p$.
\end{theorem*}
\begin{proof}
The proof is by means of contradiction. Let us assume that for infinitely many values of $p$, there exists an $H>p^{\nicefrac{1}{4}+\delta}$ for some $\delta>0$, such that $\Big \lvert \sum\limits_{x=N+1}^{N+H}\chi_2(x)\Big \rvert=H$, for some $N\in \mathbb{Z}$. We already know that for large enough $p$, $H>cp^{\nicefrac{1}{2}}$, where $c$ is some constant, there can be no interval of all quadratic residues or all non-residues. We take $p$ to be large enough that $H\leq cp^{\nicefrac{1}{2}}$.\\
We take numbers in a set $\mathcal{Q}$, which are pair-wise co-prime (as required for the application of lemma 3 later), to be the primes in the range $[\nicefrac{p^{\nicefrac{1}{4}}}{2},p^{\nicefrac{1}{4}}]$.
This satisfies the constraint in (\ref{lemma3cond}) for large enough $p$. The number of primes $\lvert\mathcal{Q}\rvert=Q$ is given by $Q=\pi(p^{\nicefrac{1}{4}})-\pi(\frac{p^{\nicefrac{1}{4}}}{2})=o(p^{\nicefrac{1}{4}})$ by the prime number theorem. Now, restating the assumption:
\begin{equation} \label{eq:p4assum}
\bigg \lvert\sum\limits_{x=N+1}^{N+H}\chi_2(x)\bigg \rvert=H
\end{equation}
In the next few steps, we proceed to transform the interval in eq. \ref{eq:p4assum} into several smaller intervals as discussed in the previous section. For a fixed $x$, $x+tp$ is divisible by a $q\in\mathcal{Q}$ for exactly one value of $t\in\{0,1,...q-1\}$. Also $\chi(x+tp)=\chi(x)$. Thus:
\[
\bigg \lvert\sum\limits_{x=N+1}^{N+H}\chi_2(x)\bigg \rvert=\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{\substack{x=N+1\\x+tp\divides q}}^{N+H}\chi_2(x+tp)\bigg \rvert=H
\]
Since $q\divides x+tp$, thus $x+tp=qz$ for some $z\in\mathbb{Z}$, $\Rightarrow z=\frac{x+tp}{q}$.\\
For $N+1\leq x \leq N+H$, we see that all such corresponding $z$ obtained are the integer values in $I(q,t)$ according to lemma 3, $t$ being the corresponding values such that $q \divides x+tp$. We will refer to the set of integers in $I(q,t)$ by $I_o(q,t)$
$$\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{\substack{x=N+1\\q\divides x+tp}}^{N+H} \chi_2 \Big(\frac{x+tp}{q}.q\Big)\bigg \rvert=H$$
$$\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z.q)\bigg \rvert=H$$
\begin{equation} \label{chapter3refeq}
\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z)\chi_2(q)\bigg \rvert=H
\end{equation}
Now, since $\lvert a\rvert + \lvert b\rvert \geq \lvert a+b \rvert\  \forall a,b \in \mathbb{Z}$
$$\sum\limits_{t=0}^{t=q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\chi_2(q)\bigg \rvert \geq H$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t=0}^{t=q-1}\bigg \lvert\chi_2(q)\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert \geq HQ$$
$$\sum_{q\in\mathcal{Q}}\bigg \lvert\chi_2(q)\bigg\rvert\sum\limits_{t=0}^{t=q-1}\bigg\lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert \geq HQ$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t=0}^{t=q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert \geq HQ$$
Separating the possibly overlapping intervals from the disjoint intervals:
\begin{equation} \label{separation}
\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert+\sum_{q\in\mathcal{Q}}\sum\limits_{\substack{t=0\\t\not \in T(q)}}^{q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert \geq HQ
\end{equation}
Now,
\begin{equation} \label{overlapping}
\sum_{q\in\mathcal{Q}}\sum\limits_{\substack{t=0\\t\not \in T(q)}}^{q-1}\bigg\lvert\sum\limits_{z\in I_o(q,t) }\chi_2(z)\bigg \rvert \leq \sum\limits_{q\in\mathcal{Q}} Q\bigg\lceil\frac{H}{q}\bigg\rceil \leq \sum\limits_{q\in\mathcal{Q}} Q\frac{2H}{q} < 4Q^2 Hp^{\nicefrac{-1}{4}}
\end{equation}
since $\sum\limits_{q_o\in\mathcal{Q}} \nicefrac{1}{q} < Q.\Big(\frac{p^{\nicefrac{1}{4}}}{2}\Big)^{-1}$. Using \ref{separation} and \ref{overlapping},
\begin{equation} \label{eq:disjointintlimit}
\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert > HQ - 4Q^2 Hp^{\nicefrac{1}{4}}=HQ(1-4Qp^{\nicefrac{-1}{4}})>\frac{HQ}{2}
\end{equation}
for large enough $p$, since $Q=o(p^{\nicefrac{1}{4}})$. Since all $I(q,t)$ such that $t\in T(q)\ \forall q\in\mathcal{Q}$ are mutually disjoint, and $\bigcup\limits_{q\in\mathcal{Q}}\bigcup\limits_{t\in T(q)} I_o(q,t) \subseteq \{0,1,...,p-1\}$,
\[\sum\limits_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z) \rvert ^{2r} \leq \sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert ^{2r}\]
Thus, converting the left-most side of eq. \ref{eq:disjointintlimit} in a form compatible with lemma \ref{lemma2statement} can help put an upper bound on it, which we now aim to do.
%$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\sum\limits_{m=0}^{h}\chi_2(z+m)\bigg \rvert \leq \sum\limits_{x=0}^{p-1}S_h)(x)$
$$\sum\limits_{\mathclap {z\in I_o(q,t)}}\chi_2(z+m) = \sum\limits_{\mathclap{z\in I_o(q,t)}}\chi_2(z)- \phi_m$$
where $\phi_m\leq 2m$
$$\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z+m) = \sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z)- \sum\limits_{m=0}^{h-1}\phi_m$$
$$\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z+m) + \sum\limits_{m=0}^{h-1}\phi_m= h\sum\limits_{z\in I_o(q,t)}\chi_2(z)$$
$$\bigg \lvert\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi_2(z+m) + \sum\limits_{m=0}^{h-1}\phi_m \bigg \rvert= \bigg \lvert h\sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert$$
Since $\lvert a\rvert + \lvert b\rvert \geq \lvert a+b \rvert$,
$$\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi_2(z+m) \bigg \rvert + \bigg\lvert\sum\limits_{m=0}^{h-1}\phi_m\bigg\rvert \geq h\bigg \lvert \sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert$$
$$\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi_2(z+m) \bigg \rvert \geq h\bigg \lvert \sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert-h^2 $$
\[
\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi_2(z+m) \bigg \rvert \geq h\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert \sum\limits_{z\in I_o(q,t)}\chi_2(z)\bigg \rvert-Qp^{\nicefrac{1}{4}}h^2
\]
since the number of the disjoint intervals $I(q,t)$ given by lemma 3 are less than $Qp^{\nicefrac{1}{4}}$. From the estimate in eq. \ref{eq:disjointintlimit}:
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi_2(z+m) \bigg \rvert > \frac{HhQ}{2}-Qp^{\nicefrac{1}{4}} h^2=Qh\big(\frac{H}{2}-hp^{\nicefrac{1}{4}}\big)$$
Taking $h<\frac{1}{4}p^{\nicefrac{-1}{4}}H$, and using the the definition of $S_h$ from lemma 2,
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert > \frac{HhQ}{4}$$
Using Holder's inequality,
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert \leq \bigg ( \sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z) \rvert^{2r} \bigg )^{\nicefrac{1}{2r}}\bigg ( \sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}1 \bigg )^{1-\nicefrac{1}{2r}}$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert^{2r} \geq \bigg ( \sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z) \rvert \bigg )^{2r} \bigg ( \sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}1 \bigg )^{-(2r-1)}$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert^{2r} > \Big( \frac{HhQ}{4}\Big)^{2r}(QH)^{-(2r-1)}$$
$$\sum\limits_{z=0}^{p-1}\lvert S_h(z-1) \rvert^{2r} = \sum\limits_{z=0}^{p-1}\lvert S_h(z) \rvert^{2r}>\Big(\frac{1}{4}\Big)^{2r}HQh^{2r}$$
From lemma 2,
\begin{equation} \label{eq:finalineq}
(2r)^{r}h^{r}p+h^{2r}r(2p^{\nicefrac{1}{2}}+1)>\Big(\frac{1}{4}\Big)^{2r}HQh^{2r}
\end{equation}
To analyse \ref{eq:finalineq}, we first estimate a lower bound on the value of $Q$. By the prime number theorem, for any $\varepsilon>0$ for large enough $p$:
%\[Q = \pi(p^{\nicefrac{1}{4}})-\pi(\frac{p^{\nicefrac{1}{4}}}{2}\]
\[\pi(p^{\nicefrac{1}{4}}) > (1-\varepsilon)\frac{p^{\nicefrac{1}{4}}}{\log (p^{\nicefrac{1}{4}})}\quad\text { and}\]
\[\pi(\nicefrac{p^{\nicefrac{1}{4}}}{2}) < (1+\varepsilon)\frac{\nicefrac{p^{\nicefrac{1}{4}}}{2}}{\log (\nicefrac {p^{\nicefrac{1}{4}}}{2})} < (1+\varepsilon)\frac{p^{\nicefrac{1}{4}}}{2(\log (p^{\nicefrac{1}{4}}) - \log 2)} < (1+\varepsilon)\frac{p^{\nicefrac{1}{4}}}{2(1-\varepsilon)\log (p^{\nicefrac{1}{4}})}\]
since $\varepsilon\log (p^{\nicefrac{1}{4}}) > \log 2$ for large enough $p$. Thus:
\[Q > (1-\varepsilon)\frac{p^{\nicefrac{1}{4}}}{\log (p^{\nicefrac{1}{4}})} - (1+\varepsilon) \frac {p^{\nicefrac {1}{4}}} {2(1-\varepsilon)\log (p^{\nicefrac{1}{4}})} = \frac {p^{\nicefrac {1}{4}}}{2 \log (p^{\nicefrac {1}{4}})}.\Big(4-\varepsilon-\frac{3}{1-\varepsilon}\Big)\]
\[ > \frac {p^{\nicefrac {1}{4}}}{2 \log (p^{\nicefrac {1}{4}})}.\frac {1}{2} = \frac {p^{\nicefrac {1}{4}}}{\log p} \text { for an appropriate }\varepsilon \text {, for large enough }p\]
In inequation (\ref{eq:finalineq}), the second term of the LHS diminishes compared to the RHS for large enough $p$, because:
\[ \frac{h^{2r}r(2p^{\nicefrac{1}{2}}+1)}{(\nicefrac{1}{4})^{2r}HQh^{2r}} \leq c\frac{p^{\nicefrac{1}{2}}}{HQ} \leq c\frac{\log p}{p^{\delta}} \in o(1)\]
where $c$ is a placeholder for any constant. Now, we take $h=\left \lfloor \frac{1}{5}p^{\nicefrac{-1}{4}}H \right \rfloor$. Taking some value of $r>\delta^{-1}$ results in the first term of the LHS of (\ref{eq:finalineq}) diminishing with respect to the RHS, as:
\[\frac{(2r)^{r}h^{r}p}{(\nicefrac{1}{4})^{2r}HQh^{2r}} \leq c \frac{p\log p}{p^{\nicefrac{1}{2}+\delta}h^r} < c\frac{p^{\nicefrac{1}{2}}\log p}{p^{\delta}.p} \leq c\frac{\log p}{p^{\nicefrac{1}{2}+\delta}} \in o(1)\]
since $h>(\nicefrac{1}{6})p^{\delta}$, for large enough $p$. Thus, we have arrived at a contradiction. Our assumption that $\Big \lvert \sum\limits_{x=N+1}^{N+H}\chi_2(x)\Big \rvert=H$ for $H>p^{\nicefrac{1}{4}+\delta}$ for infinitely many $p$ was wrong as inequation (\ref{eq:finalineq}) thus derived for such $p$ cannot hold for large enough $p$. Hence, the only possibility is that $\Big \lvert \sum\limits_{x=N+1}^{N+H}\chi_2(x)\Big \rvert<H$ for $H>p^{\nicefrac{1}{4}+\delta}$ for large enough $p$, for any $\delta>0$, proving Theorem \ref{thm:p4bound}.
\end{proof}
%
%
\section{Extension to general characters}
%Lemma 1 extension with reference to general characters
%
%Analogous proof of lemma 2 (but complete), without too deep an explanation, extend the o(p^1/2) simply
%
%Literally the same p^(1/4) section with extra modulus symbols. Very compact proof
Now we consider a natural extension of what we have proven so far: extending the result to general characters, i.e. finding an upper bound on the largest interval of elements in which a character assumes the same value. Formally,
\begin{theorem} \label{thm:genp4bound}
Given a character $\chi$ modulo prime $p$, for any $H>p^{\nicefrac{1}{4}+\delta}$, where $\delta>0$:
\[\sum\limits_{n=x+1}^{n+H}\lvert\chi(n)\rvert<H\]
for any $x\in\mathbb{Z}$, for large enough $p$.
\end{theorem}
Although a more general form of lemma 1 for general characters exists, a possible impediment in reapplying the former proof technique is dealing with the complex numbers involved in general characters. But as it turns out, we can easily extend the previously used techniques and theorems in the complex domain to obtain the same results for a general character.

The general form of lemma 1 for any character is:
\begin{lemma} \label{lemma4}
\textup{\cite{schmidt}}Let $\chi$ be a non-trivial character of order $d$. Let $f(x)$ be a polynomial which is not a perfect $d^{th}$ power, with coefficients from $\mathbb{Z}$. Let $f(x)$ have $\nu$ distinct zeroes. Then,
$$\Big\lvert\sum\limits_{x=0}^{p-1}\chi(f(x))\Big\rvert\leq (\nu -1)p^{\nicefrac{1}{2}}$$
\end{lemma}
We note that $d \divides p-1$, because since $\chi^{d}(x)=1$ and $\chi(x^{p-1})=\chi^{p-1}(x)=1$ for $x\neq0$, $\chi^{gcd(d,p-1)}(x)=1$ for $x\neq0$ using Euclid's algorithm for calculating gcd\footnotemark, and since $gcd(d,p-1)\leq d$, $d$ is the order only if $gcd(d,p-1) = d$, which is only when $d \divides p-1$.

We now use lemma \ref{lemma4} to derive lemma \ref{lemma2statement} for a general character.
%%
\subsection{Proving Lemma \ref{lemma2statement} for a General Character}
We define
\begin{equation} \label{definesh}
S_h(x)=\sum\limits_{n=1}^{h}\chi(x+n)
\end{equation}
We then expand the sum $\lvert S_h(x)\rvert^{2r}$:
$$\lvert S_h(x)\rvert^{2r}= \Big\lvert\sum\limits_{n=1}^{h}\chi(x+n)\Big\rvert^{2r}= \Big(\sum\limits_{n=1}^{h}\chi(x+n)\Big)^r\Big(\overline{\sum\limits_{n=1}^{h}\chi(x+n)}\Big)^r$$
%\vspace*{-\baselineskip}
\begin{multline*}
\lvert S_h(x)\rvert^{2r} =\bigg(\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{r}=1}}^h \chi(x+m_1)\chi(x+m_2)...\chi(x+m_{r})\bigg)
\\
\bigg(\sum\limits_{m_{r+1}=1}^h\sum\limits_{m_{r+2}=1}^h...\sum\limits_{m_{2r}=1}^h \overline{\chi(x+m_{r+1})\chi(x+m_{r+2})...\chi(x+m_{2r})}\bigg)
\end{multline*}
\begin{multline*}
\lvert S_h(x)\rvert^{2r} =\bigg(\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{r}=1}}^h \chi\big((x+m_1)(x+m_2)...(x+m_{r})\big)\bigg)
\\
\bigg(\sum\limits_{m_{r+1}=1}^h\sum\limits_{m_{r+2}=1}^h...\sum\limits_{m_{2r}=1}^h \overline{\chi}\big((x+m_{r+1})(x+m_{r+2})...(x+m_{2r})\big)\bigg)
\end{multline*}
Using the property of a character that $\overline{\chi}(x)=\chi (x^{-1})$ for $x\neq0$:
\begin{multline*}
\lvert S_h(x)\rvert^{2r} =\bigg(\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{r}=1}}^h \chi\big((x+m_1)(x+m_2)...(x+m_{r})\big)\bigg)
\\
\bigg(\sum\limits_{m_{r+1}=1}^h\sum\limits_{m_{r+2}=1}^h...\sum\limits_{m_{2r}=1}^h \chi\big((x+m_{r+1})^{p-2}(x+m_{r+2})^{p-2}...(x+m_{2r})^{p-2}\big)\bigg)
\end{multline*}
$$=\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{2r}=1}}^h \chi\big((x+m_1)(x+m_2)...(x+m_{r})\big((x+m_{r+1})(x+m_{r+2})...(x+m_{2r})\big)^{p-2}\big)$$
\begin{equation} \label{generaltuple}
\sum_{x=0}^{p-1}\lvert S_h(x)\rvert^{2r}= \sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{m_{2r}=1}^h
\sum_{x=0}^{p-1}\chi\Big(\prod_{i=1}^r(x+m_i)\prod_{i=r+1}^{2r}(x+m_{i})^{p-2}\Big)
\end{equation}
In equation \ref{generaltuple}, we must separate the perfect $d^{th}$ power polynomials formed in the sum from the rest. We do this, again as in the case of quadratic characters, by examining the tuples formed by $(m_1, m_2...m_{2r})$:
\renewcommand{\labelitemii}{$\circ$}
\begin{itemize}
\item \textbf{Perfect $\boldsymbol{d^{th}}$ power polynomials:} Since $d \divides p-1\Rightarrow \gcd(d, p-2)=1$, no power of $\big((x+m)^{p-2}\big)$ less than the $d^{th}$ power will form a perfect $d^{th}$ power polynomial. Thus, a tuple represents a perfect $d^{th}$ power polynomial if:
\begin{itemize}
    \item For each distinct element occurring in the multiset\footnote{Multisets are an extension of the concept of sets, the only difference being that a multiset can contain duplicate elements, which hence also contribute to the cardinality. Thus, the multisets $\{a, a, b, b, b\}$ and $\{a, a, a, b, b\}$ are different, while the multisets $\{a, a, b\}$ and $\{a, b, a\}$ are equal.} $M_1=\{m_1,m_2,\ldots, m_r\}$, we remove the maximum possible multiple of $d$ occurrences of the element in $M_1$, from $M_1$. This results in multiset $R_1$ consisting of the remaining elements, with their remaining occurrences which are less than $d$.
    \item Similarly for multiset $M_2=\{m_{r+1}, m_{r+2}, \ldots, m_{2r}\}$ we construct multiset $R_2$, as we did $R_1$ from $M_1$.
    \item Now, each occurrence of an element in $R_1$ can be paired bijectively with an occurrence of the same element in $R_2$
\end{itemize}
Thus, the total number of such polynomials is not more than:
\[ (r!)h^r+\sum_{k=1}^{\lfloor\nicefrac{r}{d}\rfloor}\Bigg(\frac{\binom{r-0.d}{d}\binom{r-1.d}{d}...\binom{r-(k-1)d}{d}}{k!}\Bigg)^2\frac{\binom{r-kd}{1}^2\binom{r-kd-1}{1}^2...\binom{1}{1}^2}{(r-kd)!}h^{2k+r-kd}\]
\[
\leq (r!)h^r+(r!)^2 h^{r}\sum_{k=1}^{\lfloor\nicefrac{r}{d}\rfloor}\max_k \frac{1}{(d!)^{2k}(r-kd)!(k!)^2} \leq (r!)h^r+ \frac{r}{d}(r!)^2 h^{r}
\]
\[ \leq 2r(r!)^2 h^{r} \leq r^{2r}h^r \]
Thus, these polynomials contribute at most $r^{2r}h^rp$ to the sum in \ref{generaltuple}.
\item \textbf{The remaining polynomials:} The total no. of the rest of the polynomials is trivially at most $h^{2r}$. Thus, these contribute at most $h^{2r}(2r-1)p^{\nicefrac{1}{2}}$.
\end{itemize}
Hence, we arrive at the following lemma, which is a general version of lemma \ref{lemma2statement}:
\begin{lemma*}
Let $S_h(x)=\sum\limits_{n=1}^{h}\chi(x+n)$. Then,
\begin{equation} \label{lemma2gen}
\sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert^{2r}\leq h^{r}(2r)^{r}p+2h^{2r}rp^{\nicefrac{1}{2}}\leq h^{r}(2r)^{r}p+h^{2r}r(2p^{\nicefrac{1}{2}}+1)
\end{equation}
\end{lemma*}
We will henceforth refer to this lemma as lemma \ref{lemma2statement}, as quadratic characters are just a special case of characters and thus the quadratic version immediately follows.

Now, we can derive the $O(p^{\nicefrac{1}{2}})$ and $p^{\nicefrac{1}{4}+\delta}$ bounds for general characters using almost identical methods as those for quadratic residues. We derive both the $O(p^{\nicefrac{1}{2}})$ bound and the $p^{\nicefrac{1}{4}+\delta}$ bound by mimicking most steps with minor changes in assumptions and reasoning. We also eliminate many steps and accompanying explanations, for brevity and reducing repetitiveness.
%%
\subsection{The $O(p^{\nicefrac{1}{2}})$ bound for a general character}
We prove the bound of $O(p^{\nicefrac{1}{2}})$ on the largest interval of elements in $\mathbb{F}_p$ on which $\chi$ assumes the same value. Formally:
\begin{claim*}
Given a character $\chi$ modulo prime $p$, let $h$ be the greatest integer such that:
\[\bigg\lvert\sum\limits_{n=x+1}^{x+h}\chi(n)\bigg\rvert=h\]
 for any $x\in\mathbb{Z}$. Then $h\in O(p^{\nicefrac{1}{2}})$.
\end{claim*}
\begin{claimproof}
We arrive at the result by contradiction as in the case of quadratic characters. Let the largest interval of elements in $\mathbb{F}_p$, on which $\chi$ assumes the same value, be given by $h$. Then, using the definition in equation \ref{definesh}, we can say:
\[ S_h(x+k) + \sum\limits_{n=1}^k \chi(n)= S_h(x) +\  \sum\limits_{\mathclap{n=x+h+1}}^{x+k}\:\chi(n)\]
\[ S_h(x+k) + \Bigg(\sum\limits_{n=1}^k \chi(n) -\  \sum\limits_{\mathclap{n=x+h+1}}^{x+k}\:\chi(n) \Bigg) = S_h(x)\]
\[ \lvert S_h(x+k) \rvert + \Bigg\lvert\sum\limits_{n=1}^k \chi(n) -\  \sum\limits_ {\mathclap {n=x+h+1}}^{x+k} \:\chi(n) \Bigg\rvert \geq  \Bigg\lvert S_h(x+k) + \Bigg(\sum\limits_{n=1}^k \chi(n) -\  \sum\limits_ {\mathclap {n=x+h+1}}^{x+k} \:\chi(n) \Bigg) \Bigg\rvert= \lvert S_h(x)\rvert \]
by the triangle inequality for complex numbers. Thus,
\[ \lvert S_h(x+k)\rvert \geq  \lvert S_h(x)\rvert - \Bigg\lvert\sum\limits_{n=1}^k \chi(n) -\  \sum\limits_ {\mathclap {n=x+h+1}}^{x+k} \:\chi(n) \Bigg\rvert \geq \lvert S_h(x)\rvert-2k\]
Since $\lvert S_h(z)\rvert=h$ for some $z\in\mathbb{F}_p$:
\begin{equation} \label{intervcontrgen}
\sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert^{2r}\geq\sum\limits_{x=z}^{z+\lfloor\nicefrac{h}{4}\rfloor}\lvert S_h(x)\rvert^{2r} \geq h^{2r}+(h-2)^{2r}+...+(h-2\lfloor\nicefrac{h}{4}\rfloor)^{2r} \geq \frac{h^{2r+1}}{2^{2r+2}}
\end{equation}
We can now proceed exactly as in the proof of the quadratic character version of the $O(p^ {\nicefrac{1}{2}})$ bound, by taking $r=1$ and showing that equations \ref{lemma2gen} and \ref{intervcontrgen} cannot hold for $h=cp ^{\nicefrac {1}{2}}$ for any $c$ greater than some fixed $c_o$, for large enough $p$.
\end{claimproof}
%%
\subsection{The $p^{\nicefrac{1}{4}+\delta}$ bound for a general character}
We prove the upper bound of $p^{\nicefrac{1}{4}+\delta}$, where $\delta>0$, on the largest interval of elements in $\mathbb{F}_p$ on which $\chi$ assumes the same value, i.e. Theorem \ref{thm:genp4bound}. We restate the theorem:
\begin{theorem*}
Given a character $\chi$ modulo prime $p$, for any $H>p^{\nicefrac{1}{4}+\delta}$, where $\delta>0$:
\[\sum\limits_{n=x+1}^{n+H}\lvert\chi(n)\rvert<H\]
for any $x\in\mathbb{Z}$, for large enough $p$.
\end{theorem*}
\begin{proof}
The proof proceeds very similarly to the proof of theorem \ref{thm:p4bound}. In order to not seem repetitive, we will only explain the parts which are not already covered in the proof of \ref{thm:p4bound}.

We prove the theorem by contradiction as in the quadratic character version of the theorem. Assume that for infinitely many values of $p$, there exists an $H>p^{\nicefrac{1}{4}+\delta}$ for some $\delta>0$, such that $\Big \lvert \sum\limits_{x=N+1}^{N+H}\chi(x)\Big \rvert=H$, for some $N\in \mathbb{Z}$. We take $p$ to be large enough that $H\leq cp^{\nicefrac{1}{2}}$.\\
We take a set of numbers $\mathcal{Q}$ which are the primes in the range $[\nicefrac {p^{\nicefrac {1}{4}}}{2}, p^{\nicefrac {1}{4}}]$, so as to satisfy the constraint in (\ref{lemma3cond}) for large enough $p$. We denote $\lvert \mathcal{Q}\rvert$ by $Q=\pi(p^{\nicefrac{1}{4}})-\pi(\frac{p^ {\nicefrac{1}{4}}}{2})$. We proceed to manipulate $\ \sum\limits_{\mathclap{x=N+1}}^{\mathclap{N+H}}\ \chi(x)$, to apply lemma 3.
\[\bigg \lvert\sum\limits_{x=N+1}^{N+H}\chi(x)\bigg \rvert=\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{\substack{x=N+1\\x+tp\divides q}}^{N+H}\chi(x+tp)\bigg \rvert=H \]
$$\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{\substack{x=N+1\\x+tp\divides q}}^{N+H} \chi \Big(\frac{x+tp}{q}.q\Big)\bigg \rvert=H$$
$$\bigg \lvert\sum\limits_{t=0}^{t=q-1}\sum\limits_{z\in I_o(q,t)}\chi(z)\chi(q)\bigg \rvert=H$$
where $I_o(q,t)$ is the set of integers contained in $I(q,t)$. Using the complex triangle inequality:
$$\sum\limits_{t=0}^{t=q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi(z)\chi(q)\bigg \rvert \geq H$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t=0}^{t=q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi(z)\bigg \rvert \geq HQ$$
\begin{equation} \label{separationgen}
\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi(z)\bigg \rvert+\sum_{q\in\mathcal{Q}}\sum\limits_{\substack{t=0\\t\not \in T(q)}}^{q-1}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi(z)\bigg \rvert \geq HQ
\end{equation}
Now,
\begin{equation} \label{overlappinggen}
\sum_{q\in\mathcal{Q}}\sum\limits_{\substack{t=0\\t\not \in T(q)}}^{q-1}\bigg\lvert\sum\limits_{z\in I_o(q,t) }\chi(z)\bigg \rvert < 4Q^2 Hp^{\nicefrac{-1}{4}}
\end{equation}
Using \ref{separationgen} and \ref{overlappinggen},
\begin{equation} \label{sliceineqgen}
\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert\sum\limits_{z\in I_o(q,t)}\chi(z)\bigg \rvert > \frac{HQ}{2}
\end{equation}
for large enough $p$. Now, we have
$$\sum\limits_{\mathclap {z\in I_o(q,t)}}\chi(z+m) + \sum\limits_{i=1}^m\chi(b_i)= \sum\limits_{\mathclap{z\in I_o(q,t)}}\chi(z) + \sum\limits_{i=1}^m\chi(d_i)$$
where $b_i,d_i\in\mathbb{Z}$. This implies
$$\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z+m) + \sum\limits_{m=0}^{h-1}\Big(\sum\limits_{i=1}^m\chi(b_i)-\sum\limits_{i=1}^m\chi(d_i)\Big)= \sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z)$$
\[ \Bigg\lvert\sum \limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z+m) + \sum\limits_{m=0}^{h-1}\Big(\sum\limits_{i=1}^m\chi(b_i)-\sum\limits_{i=1}^m\chi(d_i)\Big)\Bigg\rvert = \Bigg\lvert \sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z) \Bigg\rvert \]
Using the complex triangle inequality,
\[
\Bigg\lvert\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z+m) \Bigg\rvert + \Bigg\lvert\sum\limits_{m=0}^{h-1}\Big(\sum \limits_{i=1}^m\chi(b_i) - \sum\limits_{i=1}^m\chi(d_i)\Big)\Bigg\rvert \geq \Bigg\lvert \sum\limits_ {m=0}^{h-1} \sum\limits_{z\in I_o(q,t)}\chi(z) \Bigg\rvert
\]
$$\Bigg\lvert\sum\limits_{m=0}^{h-1}\sum\limits_{z\in I_o(q,t)}\chi(z+m)\Bigg\rvert \geq \sum\limits_ {m=0}^{h-1} \Bigg\lvert \sum\limits_{z\in I_o(q,t)}\chi(z) \Bigg\rvert -\Bigg\lvert\sum\limits_{m=0}^{h-1}\Big(\sum\limits_{i=1}^m\chi(b_i)-\sum\limits_{i=1}^m \chi(d_i)\Big)\Bigg\rvert$$
Again by the complex triangle inequality,
$$\sum\limits_{z\in I_o(q,t)} \Bigg\lvert \sum\limits_{m=0}^{h-1} \chi(z+m)\Bigg\rvert \geq h\big\lvert\sum\limits_{\mathclap{ z\in I_o(q,t)}}\chi(z)\big\rvert -\Bigg\lvert\sum\limits_{m=0}^{h-1}2m\Bigg\rvert \geq h\big\lvert\sum\limits_{\mathclap{z\in I_o(q,t)}}\chi(z)\big\rvert -h^2$$
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi(z+m) \bigg \rvert \geq h\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\bigg \lvert \sum\limits_{z\in I_o(q,t)}\chi(z)\bigg \rvert-Qp^{\nicefrac{1}{4}}h^2$$
So from equation \ref{sliceineqgen}
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\bigg \lvert \sum\limits_{m=0}^{h-1}\chi(z+m) \bigg \rvert > Qh\big(\frac{H}{2}-hp^{\nicefrac{1}{4}}\big)$$
Taking $h<\frac{1}{4}p^{\nicefrac{-1}{4}}H$, and using the terminology from \ref{definesh},
$$\sum_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert > \frac{HhQ}{4}$$
From this point, we proceed exactly as in the case of theorem \ref{thm:p4bound}, by applying Holder's inequality to the above inequation and using the fact that $\sum\limits_{z=0}^{p-1}\lvert S_h(z) \rvert^{2r} \geq \sum\limits_{q\in\mathcal{Q}}\sum\limits_{t\in T(q)}\sum\limits_{z\in I_o(q,t)}\lvert S_h(z-1) \rvert^{2r}$. This will contradict (\ref{lemma2gen}) for large enough $p$ when we take $r>\delta^{-1}$, proving our assumption wrong.
\end{proof}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Extensions to quadratic functions of intervals}
In this chapter, we describe a solution to a subproblem of factorizing polynomials in finite fields\ignore{a practically relevant problem}, the worst-case complexity of which can be bounded by extending the scope of lemma \ref{lemma2statement}. We will also look at why theorem \ref{thm:p4bound} cannot be extended to improve the solution.
%
%
\section{The problem and a solution}
%
Factorizing polynomials in finite fields, while being an interesting problem on its own, is also a relevant problem to many areas, like coding theory and cryptography. A basic subproblem of it is factorizing a univariate quadratic polynomial in $\mathbb{F}_p$. We now formally describe this problem.
%
\begin{aim*}
Given a quadratic univariate polynomial $f(x)=ax^2+bx+c$, $a\neq 0$ with $a,b,c\in\mathbb{F}_p$, determine both its (non-constant) factors $(x+d)$ and $(x+e)$ such that $f(x)=a(x+d)(x+e)$, if such factors exist.
\end{aim*}
%
Since checking for square factors of quadratic polynomials can easily be done by checking if $b^2=2^{2}ac$, for the rest of the chapter we only consider the aim of factorizing square-free polynomials.\ignore{We next describe a method to achieve this.}

Say $f(x)$ is factorizable in $\mathbb{F}_p$ with factors $(x+d)$ and $(x+e)$. Since the $\gcd$ of two polynomials can be calculated in $\log d_e$ time, where $d_e$ is the maximum of the degrees of both polynomials, so calculating the $\gcd$ of $f(x)$ and a polynomial (say represented generically by $g_e(x)$) with known factors can be an efficient method of testing if $f(x)$ contains any of the known factors. Thus, if we were to take some $g_e(x)$ having exactly one of $(x+d)$ and $(x+e)$ as a factor, say in this case the factor $(x+d)$, then
\[\gcd(f(x),g_e(x))=(x+d)\]
and thus we can easily factorise $f(x)$ by dividing it by $(x+d)$ using polynomial long division. Along that line, we consider the polynomial $x^{\frac{p-1}{2}}-1$. It is of small size ($O(1)$), while having as factors exactly half of the set $\{(x+1),(x+2),...(x+p-1)\}$, i.e. precisely those $(x+i), i\in \mathbb{F}_p$ such that $i$ is a quadratic residue mod $p$ because for $j\in\mathbb{F}_p$:
$$j^{\frac{p-1}{2}}=1 \Leftrightarrow j\text{ is a quadratic residue}$$
Thus taking its $\gcd$ with any quadratic polynomial takes low memory as well as time, with an intuitively good chance of exactly one factor of the quadratic polynomial as the $\gcd$. We now detail an initial solution to acheive our aim:
\begin{aimsol}
Let $g(x)=x^{\frac{p-1}{2}}-1$. Compute the $\gcd$ of $f(x)$ and $g(x)$. If the result is a linear polynomial, say $(x+k)$, then $f(x)$ can easily be factorised by plynomial division. If, however, the result is not a linear polynomial, and is instead constant or quadratic, we apply a trick: We compute the $\gcd$ of $g(x)$ and $f(x+1)$. If $f(x)$ is factorisable with factors $(x+d)$ and $(x+e)$, then $f(x+1)$ has factors $(x+d+1)$ and $(x+e+1)$. The factors of $f(x+1)$ are, thus, (generally) different from the factors of $f(x)$.

Thus, despite the $\gcd$ of $g(x)$ and $f(x)$ not being linear, the $\gcd$ of $g(x)$ and $f(x+1)$ may be a linear polynomial. If it is not linear again, we reapply our trick repeatedly to increment the argument of polynomial function $f$ by constant $1$ at each application, till we obtain an $i\in\mathbb{F}_p$ such that the $\gcd$ of $g(x)$ and $f(x+i)$ is a linear polynomial. We then factorize $f(x+i)$ using its $\gcd$ with $g(x)$, to obtain the factors say $(x+d_i)$ and $(x+e_i)$ of $f(x+i)$ such that $f(x+i)=a(x+d_i)(x+e_i)$. Then $f(x)=a(x-i+d_i)(x-i+e_i)$, and thus the factors of $f(x)$ are $(x+e_i-i)$ and $(x+d_i-i)$.

However, if we are unable to obtain such an $i$ that the $\gcd$ of $g(x)$ and $f(x+i)$ is a linear polynomial throughout $\mathbb{F}_p$, we conclude that $f(x)$ is irreducible in $\mathbb{F}_p$.
\end{aimsol}
%
The worst-case time complexity of the above solution is $O(p\log p)$, which is worse than if we had simply divided $f(x)$ by each possible linear factor. However, if we prove an upper bound on the size of $i$ such that $\gcd$ of $g(x)$ and $f(x+i)$ is a linear polynomial if $f(x)$ is factorizable, we can drastically improve the worst-case time complexity, since if no such $i$ is found in the solution till the upper bound, we can safely conclude it is irreducible.

%claim and proof good
If $f(x)$ is factorisable into factors $(x+d)$ and $(x+e)$, the $i$ obtained is equal to the least $j$ such that $f(x+j)$ and $g(x)$ have a linear $\gcd$, i.e. the least $j$ such that $f(x+j)$ has exactly one factor, say $(x+d+j)$, which is a factor of  $g(x)$. This means that $d+i$ is a quadratic residue while $e+i$ is not, and also that each pair of $(d+j)$ and $(e+j)$ have the same quadratic residuosity for the same $j$ when $0\leq j<i$. Hence, for $0\leq j<i$, $\chi_2((d+j)(e+j))=1$, while $\chi_2((d+i)(e+i))=-1$ (we ignore cases where $\chi_2((d+j)(e+j))=0$, as they can be easily eliminated before computing the $\gcd$ for each $j$). Thus, an upper bound on $i$ translates to an upper bound on the length of an interval (with general element say $y$) in $\mathbb{F}_p$ such that $\chi((q+y)(r+y))=1$ for some $q,r\in \mathbb{F}_p$. We obtain such a (non-trivial) rudimentary bound in the next section by a method in \cite{shoup}, before we improve the bound by instead extending the scope of lemma \ref{lemma2statement}.
%
%
\section{$O(p^{\nicefrac{1}{2}}\log p)$ bound}
%
We describe a straightforward proof of a $p^{\nicefrac{1}{2}}\log p$ upper bound on the longest interval $I$ in $\mathbb{F}_p$ such that a square-free factorizable quadratic polynomial in $\mathbb{F}_p$ evaluates to a quadratic residue throughout $I$ based on a method by Shoup in \cite{shoup}. Precisely:
\begin{lemma*}
Given a quadratic character $\chi_2$ modulo prime $p$ and a square-free polynomial $f(x)=(x+a)(x+b)$ in $\mathbb{F}_p[x]$, let $h$ be the greatest integer such that:
\[\sum\limits_{n=x+1}^{x+h}\chi_2(f(n))=h\]
 for any $x\in\mathbb{Z}$. Then $h \in O(p^{\nicefrac{1}{2}}\log p)$.
\end{lemma*}
\begin{proof}
Suppose there is an interval $I$ in $\mathbb{F}_p$, and we are interested in whether $f$ evaluates to quadratic residues $\mod p$ in the entire interval. Since $\chi_2(v)=1$ if $v$ is a residue and $\chi_2(v)=-1$ if $v$ is not, $\nicefrac{(\chi_2(v)+1)}{2}$ evaluates to $1$ or $0$ if $v$ is a quadratic residue or non-residue respectively. Hence, $f$ evaluates entirely to quadratic residues in $I$ if the product $\prod_{i\in I}\nicefrac{(\chi_2(f(i))+1}{2}$ evaluates to $1$, however $f$ evaluates to atleast one quadratic non-resdue in $I$ if the product evaluates to $0$. Hence the number of intervals of size $t$ in $\mathbb{F}_p$ which consist only of quadratic residues is:
\[ \sum_{x=1}^{p-t}\prod_{i=0}^{t-1}\bigg(\frac{(\chi_2(f(x+i))+1}{2}\bigg) \]
\[ =2^{-t}\sum_{x=0}^{p-t-1}\prod_{i=1}^{t}(\chi_2((x+a+i)(x+b+i))+1) \]
\[ =2^{-t}\sum_{x=0}^{p-t-1}\sum_{\substack{(e_1,...,e_{t})\\ \in\{0,1\}^{t}}}\prod_{i=1}^{t} \chi_2\big((x+a+i)(x+b+i)\big)^{e_i} \]
\begin{equation} \label{eq:e_i}
=2^{-t}\sum_{\substack{(e_1,...,e_{t})\\ \in\{0,1\}^t}}\sum_{x=0}^{p-t-1}\chi_2\Big(\prod_{i=1}^{t} \big((x+a+i)(x+b+i)\big)^{e_i}\Big)
\end{equation}
In the expression in \ref{eq:e_i}, for $\{(e_1,...,e_{t})\}=\{0\}^t$ the expression $\prod_{i=1}^{t} \big((x+a+i)(x+b+i)\big)^{e_i}$ evaluates to $1$, and $\chi(1)=1$. For other values of $(e_1,...,e_{t})$, we show that $\chi_2\Big(\prod_{i=1}^{t} \big((x+a+i)(x+b+i)\big)^{e_i}\Big)$ is never a perfect square: Suppose $l>0$ of the $e_i$'s are $1$ in the tuple $e_1,...,e_t$. Then $\chi_2\Big(\prod_{i=1}^{t} \big((x+a+i)(x+b+i)\big)^{e_i}\Big)$ can only be a perfect square if for distinct $i_1,i_2...i_l\in\{1,2,..t\}$:
\[ a+i_1=b+i_2,\text{ } a+i_2=b+i_3,\text{ } ... a+i_l=b+i_1,\text{ } \]
\[ \Rightarrow \sum_{j=1}^{l} (a + i_j)= \sum_{j=1}^{l} (b + i_j) \Rightarrow \sum_{j=1}^{l} a = \sum_{j=1}^{l} b \Rightarrow la = lb \Rightarrow a = b\]
which is a contradiction to the fact that $f(x)$ is square-free. Hence, \ref{eq:e_i} is equal to:
\[ =2^{-t}\bigg(\sum_{x=0}^{p-t-1}1+ \sum_{\substack{(e_1,...,e_{t})\in \\ \{0,1\}^t-\{0\}^t}} \sum_{x=0}^{p-t-1} \chi_2\Big(\prod_{i=1}^{t} \big((x+a+i)(x+b+i)\big)^{e_i}\Big)\bigg) \]
\[ \leq 2^{-t}((p-t)+(2^{t}-1)((2t-1)p^{\nicefrac{1}{2}}+t) \]
\[ \leq 2^{-t}(p-t)+ (2t-1)p^{\nicefrac{1}{2}}+t \]
The longest interval possible, in which $f(x)$ evaluates to only quadratic residues, is one which can be made if all the $t$ length intervals occurred consecutively (i.e. the starting points are consecutive). Thus, the longest interval cannot be of length more than $2^{-t}(p-t)+ (2t-1) p^ {\nicefrac {1}{2}} +t+t$. Setting $t=\lceil\nicefrac{(\log p)}{2}\rceil$, this length comes to not more than:
\[p^{-\nicefrac{1}{2}}(p- \lceil\nicefrac{(\log p)}{2}\rceil)+ (2\lceil\nicefrac{(\log p)}{2}\rceil-1) p^ {\nicefrac {1}{2}} +2\lceil\nicefrac{(\log p)}{2}\rceil\]
\[ \leq p^ {\nicefrac {1}{2}} - p^ {-\nicefrac {1}{2}} \lceil\nicefrac{(\log p)}{2}\rceil + 2p^ {\nicefrac {1}{2}} \lceil\nicefrac{(\log p)}{2}\rceil - p^ {-\nicefrac {1}{2}} + 2\lceil\nicefrac{(\log p)}{2}\rceil \in O(p^{\nicefrac{1}{2}}\log p) \]
In the next %section, we improve the bound to $O(p^{\nicefrac{1}{2}}\log p)$.

%Consider the product $\prod_{i\in I}\frac{(1+\chi_2 ()}{2}$
\end{proof}
%
%
\section{Lemma 2 extended}
%
Our aim is to find an upper bound on the maximum length of an interval, say $I$, in $\mathbb{F}_p$, such that $\chi_2((y+q)(y+r))=1 \text{ }\forall y\in I$ for some $q,r\in \mathbb{F}_p$. For this, we proceed in a similar manner as for finding the longest interval of quadratic residues or non-residues, intuitively due to lemma \ref{lemma4} being applicable to any square-free polynomial. We are able prove an extended version of lemma \ref{lemma2statement} for factorisable square-free quadratic functions of intervals:
%
\begin{lemma} \label{lemma5statement}
Let $f(x)=(x+a)(x+b)$ be a square-free polynomial, where $a,b\in \mathbb{F}_p$,and let $S_h(x)=\sum\limits_{n=1}^{h} \chi_2(f(x+n))$, where $h<p$. Then,
\begin{equation} \label{lemma5}
\sum\limits_{x=0}^{p-1}\lvert S_h(x)\rvert ^{2r}\leq h^{r}(2r)^{r}p+h^{2r}r(4p^{\nicefrac{1}{2}}+1)
\end{equation}
\end{lemma}
\begin{proof}
We procede in a fashion very similar to lemma \ref{lemma2statement}.
\[S_h(x)=\sum\limits_{n=1}^{h} \chi_2\big(f(x+n)\big)\]
\[(S_h(x))^{2r}=\Bigg(\sum\limits_{n=1}^{h} \chi_2\big(f(x+n)\big)\Bigg)^{2r}\]
\[=\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h...\sum\limits_{\mathclap{m_{2r}=1}}^h\chi_2\big(f(x+m_1)\big)\chi_2\big(f(x+m_2)\big)...\chi_2\big(f(x+m_{2r})\big)\]
\[\sum\limits_{x=0}^{p-1}(S_h(x))^{2r} = \sum\limits_{x=0}^{p-1}\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h... \sum\limits_{\mathclap{m_{2r}=1}}^h\chi_2\big(f(x+m_1)f(x+m_2)...f(x+m_{2r})\big)\]
\[=\sum\limits_{x=0}^{p-1}\sum\limits_{m_1=1}^h\sum\limits_{m_2=1}^h... \sum\limits_{\mathclap{m_{2r}=1}}^h\chi_2\big((x+m_1+a)(x+m_1+b)...(x+m_{2r}+a)(x+m_{2r}+b)\big)\]


To evaluate this sum we follow the dichotomy procedure used in the proof of lemma \ref{lemma2statement}. We first determine which values of the tuple $(m_1, m_2,...m_{2r})$ (which correspond bijectively to the polynomial $F(x)=\prod_{k=1}^{2r}f(x+m_k)$ represented inside the summation) represent a perfect square: Since the polynomial representation $(x+m_1+a) (x+m_1+b) ... (x+m_{2r}+a) (x+m_{2r}+b)$ of $F(x)$ is completely factorised, it will be a square when each distinct factor occurs with an even power.

We now determine how many tuples represent a perfect square: Say a tuple $(t_1, t_2,...,t_{2r})$ represents a perfect square. Say there are $s$ pairs of $t_i$ and $t_j$, both being elements in the multiset\footnotemark $\{t_1, t_2,...,t_{2r}\}$ (each element in all pairs is a different multiset element, i.e. at a distinct position in the tuple), such that $t_i=t_j$, where $0\leq s\leq r$. Each pair corresponds to the factors $f(x+t_i)$ and $f(x+t_i)$ of $F(x)$. Since $t_i=t_j$, $f(x+t_i)f(x+t_i)$ is a square, and hence $\frac{F(x}{f(x+t_i)f(x+t_i)})$ is a square.

Now, let the remaining elements of $\{t_1, t_2,...,t_{2r}\}$, after removing all $s$ pairs, be the multiset $T_o$. Then the elements of $T_o$ are all distinct. The factors in $F(x)$ corresponding to the elements of $T_o$ also form a perfect square, say the polynomial $F_T$. But since the elements of $T_o$ are all distinct, a linear factor of $F_T$ (say) $(x+a+t_u)$ can only be equal to one other linear factor of $F_T$, of the form $(x+b+t_v)$, $t_u,t_v\in T_o$, to form the perfect square that is $F_T$.
Similarly, $(x+a+t_v)$ can only be equal to a (possible) factor $(x+b+t_w)$ of $F_T$, where $t_w=t_v+(a-b)$, thus such a $t_w$ must exist in $T_o$. For pairing $(x+a+t_w)$, we need the existence of $t_w+(a-b)=t_v+2(a-b)$ in $T_o$. Since $a-b \not\divides p$, $t_v, t_v+(a-b), t_v+2(a-b),...t_v+(p-1)(a-b)$ are all distinct and thus form all the elements of $\mathbb{F}_p$, and also have to be in $T_o$ for $F_T$ to be a perfect square. But since $T_o\subseteq \{1,2,...h\}$, this is not possible. Hence if $f(x)$ is a square, elements in multiset $\{t_1, t_2,...,t_{2r}\}$ can be exhaustively paired.

Thus there can be less than $h^r(2r)^r$ tuples which represent perfect squares as calculated in Chapter 2, and thus their contribution to the sum is at most $ph^r(2r)^r$. And there can be trivially $h^{2r}$ tuples for polynomials which are not a perfect square. By lemma \ref{lemma4}, we know that each polynomial contributes at most $(4r-1)p^{\nicefrac{1}{2}}$, and thus the contribution to the sum is at most $h^{2r}(4r-1)p^{\nicefrac{1}{2}}$, and hence lemma \ref{lemma5statement} follows.
\footnotetext{Multisets are an extension of the concept of sets, the only difference being that a multiset can contain duplicate elements, which hence also contribute to the cardinality. Thus, the multisets $\{a, a, b, b, b\}$ and $\{a, a, a, b, b\}$ are different, while the multisets $\{a, a, b\}$ and $\{a, b, a\}$ are equal.}
%
%We first sum count with each possible number of pairs of t which are equal. Then the rest of the factors will be equal due to t1+a=t2+b, thus t1-t2=fixed. since if t1+a=t2+ainvolved, means counted already. thus chain forms due to a pairing of even one opposite c. which means out of bounds t.
\begin{comment}
A factor will occur in an even power when each multiplicative term in the expanded representation (each term has a power of exactly 1) $(x+a+m_1)(x+b+m_1) (x+a+m_2)(x+b+m_2) ...(x+a+m_{2r}) (x+b+m_{2r})$ can be paired with another term, such that both terms evaluate to the same linear polynomial when substituted with the $m$ additive term in them. Say a generic pair of terms is $(x+c_i+m_i)$ and $(x+c_j+m_j)$, where $c_i$ and $c_j$ each stand for whichever of $a$ or $b$ occurs in the respective paired term. The pair can occur in two ways:
\begin{itemize}
    \item $c_i=c_j$ and thus $m_i=m_j$, i.e. $(x+a+m_i)=(x+a+m_j)$ or $(x+b+m_i)=(x+b+m_j)$
    \item $c_i\neq c_j$, and thus $(x+a+m_i)=(x+b+m_j)$ or $(x+b+m_i)=(x+a+m_j)$
\end{itemize}

add factorizable means completely factorizable in intro
\end{comment}
\end{proof}
%
%
\section{Conclusion}
%
The $O(p^{\nicefrac{1}{2}})$ bound follows from lemma \ref{lemma5statement} using the technique of Chapter 2. We only formally state it:
\begin{lemma*}
Given a quadratic character $\chi_2$ modulo prime $p$ and a square-free factorizable quadratic polynomial function $f$ in $\mathbb{F}_p$, let $h$ be the greatest integer such that:
\[\bigg\lvert\sum\limits_{n=x+1}^{x+h}\chi_2(f(n))\bigg\rvert=h\]
 for any $x\in\mathbb{Z}$. Then $h\in O(p^{\nicefrac{1}{2}})$.
\end{lemma*}
In other words, the smallest whole number $y$ such $\chi_2((q+y)(r+y))=1$ is in $O(p^{\nicefrac{1}{2}})$, which places an upper bound on our factorisation method.
We cannot obtain the bound of $O(p^{\nicefrac{1}{4}+\delta})$ as for $\chi_2$ of linear function intervals due to the fact that in e.q. \ref{chapter3refeq}, $\chi_2(z.q)=\chi_2(z)\chi_2(q)$, but if the function on the interval becomes $f(x)$ instead of $x$, then $\chi_2(f(q.z))\neq \chi_2(f(q))\chi_2(f(q))$. Due to this, the proof cannot proceed involving residuosity of a quadratic function of an interval in $\mathbb{F}_p$ as in the case of simply finding the first quadratic residue/non-residue in an interval. In conclusion, we can easily obtain a $O(p^{\nicefrac{1}{2}})$, but since the multiplicity of $\chi(x)$ does not imply multiplicity of $\chi(f(x))$, we cannot translate a given interval into many smaller equivalent intervals using Lemma 3 to obtain a $O(p^{\nicefrac{1}{4}+\delta})$ bound.
%
%Given a quadratic univariate square-free polynomial in $x$, $f(x)=ax^2+bx+c$ with $a,b,c\in\mathbb{F}_p$,
%
%We now prove the following claim about the time complexity of a method to factorize such polynomials which can be bounded
%We next describe a method of factorizing square-free quadratic univariate polynomials in $\mathbb{F}_p$.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\chapter{Quantitative Analysis}
%Aim:
%\section{Energy}
%
%
%\section{Sieving}
%
%
%\section{}
\begin{thebibliography}{9}

\bibitem{burgess}
 D. A. Burgess,
\textit{The distribution of quadratic residues and non-residues},
Mathematika 4 (1957), 106-112.

\bibitem{burton}
David M. Burton, \textit{Elementary Number Theory},
McGraw Hill, 2012.

\bibitem{tonelli}
S. Lindhurst, \textit{An analysis of Shanks's algorithm for computing square roots in finite fields},
CRM Proceedings and Lecture Notes, Vol. 19 (1999) pp. 231242.

\bibitem{polya}
G. Polya,
\textit{``{\"U}ber die Verteilung der quadratischen Eeste und Nichtreste''},
G{\"o}ttinger Nachrichten (1918), 21-29.

\bibitem{vinogradov}
I. M. Vinogradov,
\textit{``Sur la distribution des r{\'e}sidus et des non-r{\'e}sidus des puissances ''},
Journal Physico-Math. Soc. Univ. Perm, No. 1 (1918), 94-96.

\bibitem{schmidt}
W. Schmidt,
\textit{``Equations over finite fields, An elementary approach''},
Lecture Notes in Math. 536, Springer Verlag, 1976, p. 43

\bibitem{shoup}
 Victor Shoup,
\textit{Removing Randomness From Computational Number Theory}, Ph.D. thesis,
Computer Science Technical Report \#865 (August 1989), University of Wisconsin, Madison.

\end{thebibliography}
%
\end{document}
